# Python CAD Framework (Build123d Based)

Современная модульная CAD-система на базе библиотеки `build123d`, использующая принципы функционального моделирования и иерархических сборок.

## Архитектура проекта

Проект разделен на логические уровни для обеспечения масштабируемости и чистоты кода:

### 1. Детали (`parts/`)
Здесь содержатся "атомарные" компоненты системы. Каждая деталь — это функция, которая:
- Принимает только геометрические параметры.
- Возвращает объект `Part`.
- Объявляет свои "интерфейсы подключения" через **Joints** (`RigidJoint`, `RevoluteJoint` и т.д.).
- **Принцип**: Детали не знают о глобальном состоянии проекта или о том, где они будут установлены.

### 2. Сборки (`assemblies/`)
Сборки управляют композицией деталей. В качестве механизма иерархии используется стандартный для `build123d` механизм `anytree`.
- Сборка создает экземпляры деталей.
- Соединяет их через метод `connect_to`, который автоматически вычисляет локации.
- Выстраивает дерево зависимостей через атрибуты `parent` и `children`.
- Результатом работы сборки является корневой объект `Compound`, содержащий всё дерево.

### 3. Системные модули (`src/`)
Движок приложения разделен на две части:
- **`renderer.py`**: Отвечает исключительно за работу с PyVista (сцена, свет, фильтрация ребер).
- **`ui.py`**: Управляет окном PySide6, лэйаутами и взаимодействием с пользователем.

### 4. Точка входа (`main.py`)
Связующее звено, которое инициализирует сборку и передает её в UI.

## Механизм соединений

В проекте используется канонический подход `build123d` к сборкам:
1. **Joints**: В деталях определяются точки интереса.
   ```python
   RigidJoint("mount", part_obj, face.location)
   ```
2. **Connection**: В сборке детали стыкуются.
   ```python
   child_part.joints["mount"].connect_to(parent_part.joints["socket"])
   ```
3. **Hierarchy**: Назначается родитель для корректного обхода дерева.
   ```python
   child_part.parent = parent_part
   ```

## Как добавить новую деталь

1. Создайте файл в `parts/my_part.py`.
2. Опишите функцию, возвращающую `Part` с хотя бы одним `RigidJoint`.
3. В классе сборки импортируйте вашу функцию.
4. Добавьте деталь в дерево сборки и соедините её с существующими компонентами.

---
Разработано с использованием `build123d`, `pyvista` и `PySide6`.
